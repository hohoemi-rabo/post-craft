# チケット #32: 投稿タイプ作成・編集 UI

> Phase 3 | 優先度: 高 | 依存: #26, #28, #31

## 概要

投稿タイプの作成・編集フォームページを実装する。基本情報入力、プレースホルダー変数エディタ、テンプレート構造エディタ、プレビュー機能を含む。

SPEC-PHASE3.md セクション 8.4 に準拠。

## 対象ファイル

| ファイル | 操作 |
|---------|------|
| `src/app/(dashboard)/settings/post-types/new/page.tsx` | 新規作成 |
| `src/app/(dashboard)/settings/post-types/[id]/page.tsx` | 新規作成 |
| `src/components/settings/post-type-form.tsx` | 新規作成（共通フォーム） |
| `src/components/settings/placeholder-editor.tsx` | 新規作成 |
| `src/components/settings/template-editor.tsx` | 新規作成 |

## 画面構成（3セクション + プレビュー）

### セクション1: 基本情報

| 項目 | 入力方法 | バリデーション |
|------|---------|--------------|
| アイコン | 絵文字ピッカー（#31） | 必須 |
| タイプ名 | テキスト入力 | 必須、50文字以内 |
| 説明文 | テキスト入力 | 必須、200文字以内 |
| 文字数目安（最小） | 数値入力 | 必須、1以上 |
| 文字数目安（最大） | 数値入力 | 必須、最小値以上 |

### セクション2: プレースホルダー変数（placeholder-editor.tsx）

- リスト形式で表示（変数名、ラベル、必須/任意、入力タイプ）
- ドラッグ&ドロップで並び替え
- 最大10個制限
- 変数名の重複チェック
- 変数名は英数字+アンダースコアのみ

各変数の編集項目:
| 項目 | 入力方法 |
|------|---------|
| 変数名 | テキスト（`[a-z_]+` 形式） |
| 表示ラベル | テキスト |
| 説明（ヒント） | テキスト（任意） |
| 必須フラグ | トグル |
| 入力タイプ | セレクト（text / textarea） |

### セクション3: テンプレート構造（template-editor.tsx）

- テキストエリアで自由編集
- 利用可能な変数一覧を表示（`{変数名}` 形式）
- クリックで変数をテンプレートのカーソル位置に挿入
- テンプレート内の未定義変数を警告表示

### プレビュー

- テンプレートにサンプルデータを適用して表示
- プレースホルダーにはサンプル値（ラベル名等）を使用
- リアルタイム更新

### ボタン

- [キャンセル] → 一覧に戻る
- [プレビュー] → プレビューセクションをスクロール表示
- [保存] → API呼び出し → 成功時に一覧に戻る

## 新規作成 vs 編集

| 項目 | 新規作成 (/new) | 編集 (/[id]) |
|------|----------------|-------------|
| 初期値 | 空フォーム | API から取得 |
| API | POST /api/post-types | PUT /api/post-types/[id] |
| パンくず | 設定 > 投稿タイプ > 新規作成 | 設定 > 投稿タイプ > {名前}を編集 |

## 受入条件

- 新規作成フォームが正しく動作し保存できる
- 既存タイプの編集（データロード・更新）が動作する
- プレースホルダーの追加・編集・削除・並び替えが動作する
- テンプレート内の変数がクリックで挿入できる
- 未定義変数の警告が表示される
- プレビューがリアルタイムで更新される
- バリデーションエラーが適切に表示される
- 保存成功時に一覧ページに戻る

## TODO

- [ ] `src/app/(dashboard)/settings/post-types/new/page.tsx` を作成
- [ ] `src/app/(dashboard)/settings/post-types/[id]/page.tsx` を作成
- [ ] `src/components/settings/post-type-form.tsx` を作成
  - [ ] 基本情報セクション（アイコン、タイプ名、説明、文字数）
  - [ ] バリデーション表示
  - [ ] 保存・キャンセルボタン
  - [ ] 新規/編集モードの切り替え
- [ ] `src/components/settings/placeholder-editor.tsx` を作成
  - [ ] 変数リスト表示
  - [ ] 変数の追加・編集・削除
  - [ ] ドラッグ&ドロップ並び替え
  - [ ] 変数名の重複チェック
  - [ ] 最大10個制限
- [ ] `src/components/settings/template-editor.tsx` を作成
  - [ ] テキストエリア編集
  - [ ] 利用可能変数一覧表示
  - [ ] クリックで変数挿入
  - [ ] 未定義変数の警告
- [ ] プレビュー機能を実装
- [ ] モバイル対応の確認
